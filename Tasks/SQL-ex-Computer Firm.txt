CREATE DATABASE [Computer firm]
GO
CREATE TABLE Product
(maker VARCHAR(10) NOT NULL,
model VARCHAR(50) PRIMARY KEY,
type VARCHAR(50) NOT NULL)
GO
CREATE TABLE pc
(code INTEGER PRIMARY KEY,
model VARCHAR(50) NOT NULL,
speed SMALLINT NOT NULL,
ram SMALLINT NOT NULL,
hd REAL NOT NULL,
cd VARCHAR(10) NOT NULL,
price MONEY,
FOREIGN KEY (model) REFERENCES Product(model))
GO
CREATE TABLE laptop
(code INTEGER PRIMARY KEY,
model VARCHAR(50) NOT NULL,
speed SMALLINT NOT NULL,
ram SMALLINT NOT NULL,
hd REAL NOT NULL,
price MONEY,
screen TINYINT NOT NULL,
FOREIGN KEY (model) REFERENCES Product(model))
GO
CREATE printer
(code INTEGER PRIMARY KEY,
model VARCHAR(50) NOT NULL,
color char(1) NOT NULL,
type varchar(10) NOT NULL,
price MONEY,
FOREIGN KEY (model) REFERENCES Product(model))


--Computer firm DB
1)
SELECT model, speed, hd 
FROM pc
WHERE price < 500

--
from p in PCs
where p.Price < 500
select new {p.Model, p.Speed, p.Hd}

--
PCs
.Where(p => (p.Price < 500))
.Select(p => new
{
	Model = p.Model,
	Speed = p.Speed,
	Hd = p.Hd
})

2) 
SELECT DISTINCT Maker
FROM Product
WHERE type = 'Printer'

--
(from p in Products
where p.Type == "Printer"
select new {p.Maker}).Distinct()

--
Products
.Where(p => p.Type == "Printer")
.Select(p => new
{
	Maker = p.Maker
}).Distinct()


3)
SELECT model, ram, screen
FROM laptop
WHERE price > 1000

--
from l in Laptops
where l.Price > 1000
select new 
{
	Model = l.Model,
	Ram = l.Ram,
	Screen = l.Screen
}

--
Laptops
.Where(l => l.Price > 1000)
.Select(l => new
{
	Model = l.Model,
	Ram = l.Ram,
	Screen = l.Screen
})


4)
SELECT *
FROM Printer
WHERE color = 'Y'

5)
SELECT model, speed, hd
FROM Pc
WHERE cd in ('12x', '24x') AND price < 600

6)
SELECT DISTINCT Product.maker, Laptop.speed
FROM Product INNER JOIN Laptop on product.model = laptop.model
WHERE Laptop.hd >= 10

7)
SELECT PC.model, price
FROM PC INNER JOIN   
     Product ON PC.model = Product.model
where product.maker='b'
UNION
SELECT Laptop.model, price 
FROM Laptop INNER JOIN   
     Product ON Laptop.model = Product.model
where product.maker='b'
UNION
SELECT Printer.model, price 
FROM Printer INNER JOIN   
     Product ON Printer.model = Product.model
where product.maker='b'

8)
Select distinct maker
from product
where maker in 
(select maker
from product
intersect 
select maker
from product
where type = 'pc'
except
select maker
from product
where type='laptop'
)

select maker
from product
intersect 
select maker
from product
where type = 'pc'
except
select maker
from product
where type='laptop'


9)
Select distinct maker
from product
where type = 'pc'
 and model in
(select model
from pc
where speed >= '450')


10)
Select model, price
from printer
where price in 
(select max(price)
from printer)


11)
Select AVG(speed)
from pc

12) 
Select avg(speed)
from laptop
where price > 1000

13)
Select avg(speed)
from pc
where model in (
select model 
from product
where maker = 'a')

14) !!!
Select  maker, type
from product
group by type, maker
having count(model) > 1 and 


15) 
Select hd
from pc
group by hd
having count(hd) >1


17) !!!
select type, product.model, speed
from product inner join laptop on (product.model = laptop.model)
where speed < all(select speed from pc)

19) 
select maker, avg(screen)
from product inner join laptop on (product.model = laptop.model)
group by maker


21)
SELECT maker, MAX(price) as 'Maximum price'
FROM Product, PC
Where Product.model = PC.model
GROUP BY maker

22)
SELECT speed, AVG(price)
FROM PC
WHERE speed > 600
GROUP BY speed

23)
SELECT Distinct maker
From (Product inner join PC on Product.model = PC.model)
Where PC.speed >=750
intersect 
(SELECT Distinct maker
From (Product inner join laptop on Product.model = laptop.model)
Where laptop.speed >=750)


!!!
24)
Select maker, price
from product inner join printer on product.model = printer.model
where price = (select Min(price)
from Printer
where color = 'y'
)

!!!
25)
select maker
from (product inner join PC 
on product.model = PC.model)

where speed =
(select max(speed)
from PC
where ram =
(select min(ram)
from PC
))

intersect
select maker
from (product inner join printer 
on product.model = printer.model)





